---
layout: post
title: "Generic Registrations for Pandora"
guid: http://www.tigraine.at/2009/06/08/generic-registrations-for-pandora/
postid: 564
categories:
- net
- programmierung
- pandora
- projects
---
<p>Yesterday I finished <a href="http://bitbucket.org/Tigraine/pandora-container/wiki/FluentInterface">expanding the Pandora wiki</a> a bit on how to configure the container and while doing so I made one discovery:</p>  <p><strong>I never tested if Pandora can handle generic types!!</strong></p>  <p>Wow, why didn’t I think about that. One of the most important scenarios fully untested. Thank god, simple generic registration already worked:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2e6d557b-b705-4c34-b5ad-8606cf99c7de:53699686-0cff-44f6-97aa-474f7185e86d" class="wlWriterEditableSmartContent"><pre name="code" class="csharp">
[Fact]
public void CanResolveSpecificGenericClass()
{
&#160;&#160;&#160;&#160;store.Register(p =&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p.Service&lt;GenericClass&lt;string&gt;&gt;()
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.Implementor&lt;GenericClass&lt;string&gt;&gt;());

&#160;&#160;&#160;&#160;Assert.DoesNotThrow(() =&gt; container.Resolve&lt;GenericClass&lt;string&gt;&gt;());
}
</pre></div>

<p>The moment you define what generic type you are using, a generic class is just a regular class that can be used like all the others.</p>

<p>Still, it sucks having to specify one class explicitly 5 times if I want 5 to use it with 5 types. So I set out to support the following scenario:</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2e6d557b-b705-4c34-b5ad-8606cf99c7de:c523997f-3816-4084-9eb9-410f121fc35e" class="wlWriterEditableSmartContent"><pre name="code" class="csharp">
[Fact(Skip = "Not implemented yet")]
public void CanRegisterAndResolveRealGenericRequests()
{
&#160;&#160;&#160;&#160;store.Register(p =&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p.Generic(typeof(GenericClass&lt;&gt;))
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.Implementor(typeof(GenericClass&lt;&gt;))
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.ForAllTypes());

&#160;&#160;&#160;&#160;Assert.DoesNotThrow(() =&gt; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;var resolve = container.Resolve&lt;GenericClass&lt;string&gt;&gt;();
&#160;&#160;&#160;&#160;});
}
</pre></div>

<p>I want the container to just know the generic and then figure out if the generic registration can satisfy my requested service. Since this would obviously require Reflection in the resolving part of Pandora, I shelved that feature for a maybe more useful one that at least eases some of the generic pain:</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2e6d557b-b705-4c34-b5ad-8606cf99c7de:d8713c42-e2ea-4dcc-b08a-ba8ac958ade6" class="wlWriterEditableSmartContent"><pre name="code" class="csharp">
store.Register(
&#160;&#160;&#160;&#160;p =&gt; p.Generic(typeof (GenericClass&lt;&gt;))
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Implementor(typeof (GenericClass&lt;&gt;))
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .OnlyForTypes(typeof (string), typeof (int)));
</pre></div>

<p>This way I can specify in one registration what types I want the generic to serve and the Fluent interface will create a distinct registration for each type in .OnlyForTypes[]. This way I don’t need any reflection code in the resolving part of Pandora.
  <br />And: It’s already implemented.</p>

<p>You can find the source to <a href="http://bitbucket.org/Tigraine/pandora-container/">Pandora at the project website</a> on Bitbucket.</p>