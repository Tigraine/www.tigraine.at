---
layout: post
title: "Inevitable leaking of control Information"
guid: http://www.tigraine.at/2009/01/15/inevitable-leaking-of-control-information/
postid: 444
categories:
- programmierung
- patterns
---
<p>I’m wondering if anyone of you has a better solution (or thoughts) for this.</p>  <p>Assume I have a business rule that states <em>“If there is already a bill for one special order, the user should be warned when trying to create another bill”.</em>    <br />So, obviously I simply display a MessageBox telling the user he’s about to do something stupid (but he should have the choice).</p>  <p>I see a “leak” of business logic from the Controller to the GUI when I have the GUI question the controller layer if there is already a bill for the Order. The decision about whether to proceed or not has to happen in the GUI since it’s the only layer capable of displaying a messagebox to the user (simply reference wise). But the semantics of this decision actually belong into the controller. And frankly, I can’t really find a viable way to separate the logic from the Gui on this case.</p>  <p>The system is layered as follows:</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2009/01/image5.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.tigraine.at/wp-content/uploads/2009/01/image-thumb5.png" width="474" height="255" /></a>&#160;</p>  <p>The root cause of this problem is that I’m not really following the MVC pattern on this one. The GUI always calls down to the controller instead of the controller calling the GUI. This way I often see myself struggling to somehow push logic down into the controller while trying to keep the GUI free from logic. But when it comes to complex interaction I realize now that the GUI is actually driving the whole thing, and that makes this whole thing a pain to re-wire later. </p>  <p>One way to detect things like this is when your controller classes don’t contain actual state. Most of my controller methods are just taking input and applying logic to it, not actually controlling the information flow inside the application (and that should have made me suspicious a long time ago).</p>  <p>So, I guess I can blame myself on this one and will have to try to minimize the damage done until I get time to refactor the system at a later stage.    <br />Still bugs me that I fell for this, but the whole point in failing is to be able to learn from mistakes. :)</p>  <p>What also supports my case is that the controller and repository layers are very well tested, so I may be able to divide the controller layer into multiple strategy classes (logic dumps) while reworking how control flow is handled by the system.</p>