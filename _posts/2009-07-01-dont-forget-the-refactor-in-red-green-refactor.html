---
layout: post
title: "Don&rsquo;t forget the Refactor in Red-Green-Refactor"
guid: http://www.tigraine.at/2009/07/01/dont-forget-the-refactor-in-red-green-refactor/
postid: 597
categories:
- programmierung
- testing
---
<p>When first learning about TDD all sources I read focused pretty much on one thing: writing the tests. </p>  <p>Few sources really talk about the full TDD workflow:</p>  <blockquote>   <ul>     <li>Write a failing test </li>      <li>Make it pass </li>      <li>Refactor the code</li>      <li>start over </li>   </ul> </blockquote>  <p>Arguably that the hardest part of doing TDD is 1+2, while possibly the most important one is 3! </p>  <p>Some people tend to stress the fact that automated tests can be a safeguard against breaking existing code. And although I like this aspect, I believe if your code is structured well and was built with the open-closed principle in mind,&#160; chances are you’ll never touch old code in the process of implementing new features.</p>  <p>But during refactoring, you play to TDDs strengths. You don’t write new stuff, you focus on the stuff that’s already there and that already works. You search for ways to improve what’s already there while not changing it’s behavior. And very often this final refactoring step is the only thing that really brings value to your process, since it not only uses those tests you just wrote, it also facilitates future change allowing you to produce cleaner code than you would without refactoring. </p>  <p>Think of refactoring as fortifying the wall you’ll be building the next floor upon. Without it the you may be fine, but 3 floors from now you’ll have a lot of work at your hands to be able to commence work.</p>  <p>Getting things right the first time is incredibly hard. On my last project it even took me some <a href="http://www.tigraine.at/2009/03/15/the-joy-of-pair-programming/">quality pair programming</a> once to come up with something great, and 80% of the pair programming was mostly spent on refactoring a raw idea from a 80% solution into a 100% solution. So, don’t spend too much time with hunting the ideal of writing a 100% solution the first time, rather try to get it 80% right and don’t stop improving it until you are at 100%!</p>