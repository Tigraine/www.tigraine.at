---
layout: post
title: "ClickOnce and Vista UAC"
guid: http://www.tigraine.at/2008/07/01/clickonce-and-vista-uac/
postid: 317
categories:
- internet
---
<p>So far I've been using Windows Vista since day 1 it's been released here in Austria and I have been very pleased with the system. Imo Vista has a far worse reputation than it deserves. I really can't think of myself using XP any more .</p>  <p>Also I think that UAC is a very very good think in Windows Vista and really helps secure the computer against malicious programs. If you get over it popping up every 3 clicks while you set up the machine, in running state you hardly see the question any more (except for administrative tasks).   <br />So, I never ever disabled UAC until now.</p>  <p>Why? Because ClickOnce is giving me a hard time.    <br />ClickOnce is automagically working perfectly in XP because it just starts up IE and starts to bootstrap the program. But if the program requires admin rights you're out of luck in Windows Vista.</p>  <p>But, I've found a workaround for ClickOnce when you download the ClickOnce application.</p>  <p>Just start IE as administrator (right click -&gt; run as administrator) and the ClickOnce bootstrapper will eventually use the running instance of IE that has elevated rights. </p>  <p>I haven't had a way to identify why this isn't working 100% of the time, but sometimes this doesn't work either, so your only way out is to temporally disable UAC. Here's how to do it:</p>  <p>First you need to start <strong>msconfig</strong> through the run dialog (Windows-Key + R -&gt; msconfig -&gt; O)    <br />Now you select the Tools tab and need to scroll down until you find disable User Account Control (or something similar, I'm running a German Windows).</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/07/image.png"><img border="0" alt="image" src="http://www.tigraine.at/wp-content/uploads/2008/07/image-thumb.png" width="585" height="389" /></a></p>  <p>Once you've found the line simply press &quot;Launch&quot; / &quot;Starten&quot; and reboot the machine. UAC will be disabled and you can run your ClickOnce application. </p>  <p>I strongly advise you to turn UAC back on once you're done, because running in admin mode compromises your computer's security!</p>  <p>Bottomline:&#160; Try to avoid older ClickOnce applications (newly compiled ones don't have this problem) that require administrative rights to run.</p>