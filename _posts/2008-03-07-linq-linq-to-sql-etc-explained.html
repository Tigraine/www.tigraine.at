---
layout: post
title: "LinQ, LinQ to SQL etc explained"
guid: http://www.tigraine.at/2008/03/07/linq-linq-to-sql-etc-explained/
postid: 262
categories:
- net
- programmierung
---
<p>I've been talking to a lot of people about LinQ and LinQ to SQL lately and always had trouble explaining them the difference between those concepts. So, obviously I could simply point you to ScottGu's posts on <a href="http://weblogs.asp.net/scottgu/archive/2007/04/21/new-orcas-language-feature-query-syntax.aspx">LinQ</a> and <a href="http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx">Linq to SQL</a>, but that would be cheap wouldn't it?</p>  <p>So, what is LinQ in the first place? People usually mix it up with LinQ to SQL and see it as a new syntax to query databases (but that's LinQ to SQL). </p>  <p>In a nutshell, LinQ stands for <strong>L</strong>anguage <strong>in</strong>tegrated <strong>Q</strong>uery and is a great way to retrieve objects from lists, arrays etc.     <br />Basically, LinQ works an everything that implements IEnumerable, so it's quite safe to say that it works with every .NET collection out there ;).</p>  <p>So, the magic?    <br />LinQ consists of 2 things.</p>  <h4>Extension methods</h4>  <p>First: By importing the System.LinQ namespace you get some <a href="http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx">extension methods</a> for your collections. </p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linq1.png"><img height="287" alt="linq1" src="http://www.tigraine.at/wp-content/uploads/2008/03/linq1-thumb.png" width="446" border="0" /></a></p>  <p>The above screenshot shows some of the extension methods you get by importing System.LinQ.    <br />Those methods are very useful when working with collections and have become something I won't want to miss.     <br />Here are my most used ones:</p>  <p><strong><u>Select</u></strong>: Takes a <a href="http://weblogs.asp.net/scottgu/archive/2007/04/08/new-orcas-language-feature-lambda-expressions.aspx">lambda</a> and returns an IEnumerable&lt;&gt; of all items that match the lambda.     <br />Example:</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linqselect.png"><img height="77" alt="linqselect" src="http://www.tigraine.at/wp-content/uploads/2008/03/linqselect-thumb.png" width="422" border="0" /></a></p>  <p>This statement will only return an IEnumerable with Tigraine and Tig.</p>  <p><strong><u>Single</u></strong>: I love this one! Takes a lambda and returns the single item matching the lambda (failing if there is more than one).     <br />This really shines when doing stuff with unique id's.     <br />Example:</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linqselect2.png"><img height="103" alt="linqselect2" src="http://www.tigraine.at/wp-content/uploads/2008/03/linqselect2-thumb.png" width="424" border="0" /></a></p>  <p><strong><u>Any and All</u></strong>: Any checks if one or more items of the collection match the lambda, and All returns true if all items in the collection match the lambda. </p>  <h4>Query syntax</h4>  <p>So, besides all those great overloads the LinQ namespace provides the real magic is a query like this:</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linqselect3.png"><img height="75" alt="linqselect3" src="http://www.tigraine.at/wp-content/uploads/2008/03/linqselect3-thumb.png" width="382" border="0" /></a></p>  <p>Needless to say that this query syntax works on every collection of objects and provides a great strongly typed query syntax for objects.</p>  <h4>LinQ to SQL</h4>  <p>So, now that we know what LinQ is we could easily go ahead and write tons of boilerplate code that maps objects to database tables etc etc.. And then use LinQ to query all those objects we created.</p>  <p>But that wouldn't ever work, because having the whole database in memory won't work on any fairly large db. So LinQ to SQL jumps in on this.</p>  <p>LinQ to SQL consists mainly of a graphical OR/M designer in Visual Studio 2008 that allows you to simply drag and drop tables from your database to create the mappings. </p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linqsqlgui.png"><img height="134" alt="linqsqlgui" src="http://www.tigraine.at/wp-content/uploads/2008/03/linqsqlgui-thumb.png" width="214" align="left" border="0" /></a>Once the mappings are created LinQ to SQL provides you with a DataContext class that represent the objects in your database.     <br />The Users table from my database to the left result in a new collection in your data context called Users that can be queried either through extension methods or through the query syntax.</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linqsql.png"><img height="151" alt="linqsql" src="http://www.tigraine.at/wp-content/uploads/2008/03/linqsql-thumb.png" width="418" border="0" /></a> </p>  <p>What happens under the hood is that LinQ to SQL translates your LinQ query into SQL. The generated queries can be viewed while debugging:</p>  <p><a href="http://www.tigraine.at/wp-content/uploads/2008/03/linqsql2.png"><img height="51" alt="linqsql2" src="http://www.tigraine.at/wp-content/uploads/2008/03/linqsql2-thumb.png" width="559" border="0" /></a></p>  <p>The difference to normal LinQ is that LinQ to SQL gets executed once you are using the query data, not when doing the query. The query definition is just the generation of the SQL, while a foreach(var u in users) would actually trigger the query.</p>  <p>And, obviously LinQ to SQL also handles changes to the database through transactions. You just need to modify a value and hit dbContext.SubmitChanges() and LinQ packs any changes back into your database.</p>  <p><strong>Conclusion:      <br /></strong>LinQ is a clever way to query objects in memory.    <br />LinQ to SQL is a new strong OR/M that takes advantage of the new query syntax and extending it to a database.</p>  <p>This post was never intended to be an exhaustive write-up about LinQ and LinQ to SQL, if you want to know more about those two please refer to ScottGu's posts.</p>