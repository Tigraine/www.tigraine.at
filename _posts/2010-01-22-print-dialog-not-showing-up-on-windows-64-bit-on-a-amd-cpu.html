---
layout: post
title: "Print dialog not showing up on Windows 64 Bit on a AMD CPU"
guid: http://www.tigraine.at/2010/01/22/print-dialog-not-showing-up-on-windows-64-bit-on-a-amd-cpu/
postid: 819
categories:
- net
- programmierung
---
<p>Imagine the following: Clint calls telling me “Hey Daniel, I just got a new computer with Windows 7 64 Bit installed, everything is working great so far. The Software you wrote a year ago works fine on it too, only problem: I can’t print”</p>  <p>My immediate reaction: “Reboot the system” (ok kinda lame, but I have spent too much time with problems that went away through a reboot to not suggest it).    <br />Well, but the reboot didn’t help here. Even after rebooting the print dialog was still not showing up. </p>  <p>Now, I know for a fact that the Software runs fine on Win7, I also know it runs fine on Win7 x64 (since I developed it running both x32 and x64 Win7 Beta builds back in the day). And since I am using the <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.printdialog.aspx" target="_blank">PrintDialog</a> class provided by the .NET framework I wasn’t really sure what&#160; could be the issue. I mean, hey that’s a framework class, those things are supposed to run cross platform and be CPU ignorant. But hey, why not simply ask Google the most stupid question I could think of: “<a href="http://www.google.at/search?q=windows+64+.net+print+dialog&amp;hl=de&amp;esrch=FT1" target="_blank">windows 64 .net print dialog</a>” .. </p>  <p>And the answer was right there on Microsoft’s MSDN page as a remark:</p>  <blockquote>   <p>Also, The <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.printdialog.aspx">PrintDialog</a> class may not work on AMD64 microprocessors unless you set the UseEXDialog property to true.</p> </blockquote>  <p>WTF? (Ok more words come to mind, but since I don’t want to get hatemail for my language I’ll leave it at that).</p>  <p>We are talking about a class in the .NET BCL that is supposed to work cross plattform (at least Windows), be completely CPU ignorant (fully managed), and yet I have to set UseExDialog to true to see this dialog on a AMD CPU? Are you kidding me Microsoft?</p>  <p>Well, the fix was quite easy (thankfully). I went into my PrintDialogFactory and changed one line of code, packed a new release and sent it to my client, yet my confidence in BCL classes has been severely shaken.</p>  <p>I really don’t know anything about the reasons for this odd (to say the least) behavior, but I can say that I am a bit sad to see it monkey-patched like this. Especially in a VM environment like the .NET framework I expect Microsoft to solve their system-specific problems under the hood where I can’t see them and don’t have to care about them.</p>